"use strict";(self["webpackChunkmm_web"]=self["webpackChunkmm_web"]||[]).push([[991],{20991:function(e,a,t){t.r(a),t.d(a,{default:function(){return U}});var l=function(){var e=this,a=e._self._c;return a("div",{staticClass:"box"},[a("div",{staticClass:"column"},[e._v("会员管理")]),a("div",{ref:"tab",staticClass:"tab"},[a("Tabs",{attrs:{type:"card"},on:{"on-click":e.handleTabClick},model:{value:e.tab_index,callback:function(a){e.tab_index=a},expression:"tab_index"}},e._l(e.tab_list,(function(t){return a("TabPane",{key:t.id,attrs:{label:t.name,name:t.name}},[e.current(t,"会员列表")?a("VipList"):e._e(),e.current(t,"精准筛选")?a("PrecisionFilter"):e._e()],1)})),1)],1)])},i=[],s=function(){var e=this,a=e._self._c;return a("div",{staticClass:"index"},[a("VipSearch",{on:{change:e.change,search:e.searchValues}}),a("div",{staticClass:"list-top"},[a("span",{staticClass:"black"},[e._v("共"+e._s(e.vip_total)+"个会员")]),a("span",{staticClass:"black"},[e._v("（所有会员总余额：￥"+e._s(e.money)+"元")]),a("span",{staticClass:"red"},[e._v("所有会员总欠款："+e._s(e.arrears)+"元")]),a("span",{staticClass:"black"},[e._v("）")])]),a("div",{staticClass:"list"},[a("vxe-table",{ref:"xTable",attrs:{"cell-style":{textAlign:"center"},"column-config":{resizable:!0},data:e.tableData,"header-align":"center",height:e.tableHeight,loading:e.loading,"row-config":{isHover:!0,height:120},size:"small"}},[e._l(e.tableColumns,(function(t,l){return a("vxe-column",{key:l+t.key,attrs:{field:t.key,fixed:t.fixed,"min-width":t.width,"show-overflow":"title",title:t.title},scopedSlots:e._u(["会员信息"===t.title?{key:"default",fn:function({row:t}){return[a("div",{staticClass:"vip-info"},[a("div",{staticClass:"avatar-info"},[a("Avatar",{staticClass:"avatar",attrs:{src:e.avatar(t.pic_url)}})],1),a("div",[a("div",{staticClass:"name"},[e._v(" "+e._s(t.name)+" ")]),a("div",{staticClass:"tel"},[e._v(" "+e._s(t.tel)+" ")]),a("div",{staticStyle:{color:"rgb(128, 128, 140)","text-align":"left",overflow:"hidden",width:"120px","text-overflow":"ellipsis","white-space":"nowrap"},attrs:{title:t.vip_id}},[e._v(" "+e._s(t.vip_id)+" ")]),a("div",{staticStyle:{"text-align":"center",border:"1px solid rgb(34, 141, 87)","border-radius":"32px",background:"rgb(34, 141, 87)",height:"18px","line-height":"18px",color:"rgb(255, 255, 255)","margin-top":"4px","margin-bottom":"10px",width:"80px"}},[e._v(" "+e._s(t.tname)+" ")])])])]}}:"会员账户"===t.title?{key:"default",fn:function({row:t}){return[a("div",[a("span",{staticStyle:{display:"block",color:"rgb(128, 128, 140)"}},[e._v(" 持卡："+e._s(t.card_num)+"张 ")]),a("span",{staticStyle:{display:"block",color:"rgb(128, 128, 140)"}},[e._v(" 余额："+e._s(t.money)+" ")]),a("span",{staticStyle:{display:"block",color:"rgb(128, 128, 140)"}},[e._v(" 积分："+e._s(t.integral)+" ")]),a("span",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("欠款：")]),a("span",{staticStyle:{color:"rgb(246, 39, 39)"}},[e._v(e._s(t.arrears))])])])]}}:"总消费"===t.title?{key:"default",fn:function({row:t}){return[a("div",[a("span",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("消费总计：")]),a("span",[e._v(e._s(t.order_total))])])])]}}:"到店次数"===t.title?{key:"default",fn:function({row:t}){return[a("div",[a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("到店次数：")]),a("span",[e._v(e._s(t.arrival_count))])]),a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("本月到店：")]),a("span",[e._v(e._s(t.arrival_month))])])])]}}:"上次消费"===t.title?{key:"default",fn:function({row:t}){return[a("div",{staticStyle:{"text-align":"left"}},[a("span",[a("div",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v(" "+e._s(t.arrival_new_time)+" ")])]),a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("服务人员：")]),a("span",[e._v(e._s(t.arrival_new_staff))])]),a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("消费：")]),a("span",[e._v(e._s(t.arrival_new_money))])])])]}}:"生日"===t.title?{key:"default",fn:function({row:t}){return[a("div",[a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v(" "+e._s("1"===t.birthday_type?"阳历":"阴历")+" ")])]),a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v(" "+e._s(t.birthday)+" ")])]),a("div",[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("距生日")]),a("span",[e._v(e._s(t.birthday_num)+"天")])])])]}}:"绑定状态"===t.title?{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[a("div",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("已绑定")]),a("img",{staticStyle:{width:"20px",height:"20px","border-radius":"100%",overflow:"hidden"},attrs:{alt:"微信",src:e.WeChatImgUrl}})]),a("div",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{color:"rgb(128, 128, 140)"}},[e._v("已绑定")]),a("img",{staticStyle:{width:"20px",height:"20px","border-radius":"100%",overflow:"hidden"},attrs:{alt:"企业微信",src:e.WeComImgUrl}})])])]}}:null],null,!0)})})),a("vxe-column",{attrs:{fixed:"right",title:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[a("span",{staticClass:"bt",on:{click:function(a){return e.showModal("客户详情","VipDetails",t)}}},[e._v(" 详情 ")]),a("Poptip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticStyle:{cursor:"pointer"}},e._l(e.moreList,(function(l,i){return a("p",{key:i,on:{click:function(a){return e.choose(l,t)}}},[e._v(" "+e._s(l.label)+" ")])})),0)]),a("span",{staticClass:"bt"},[e._v("更多")])])]}}])})],2),a("div",{staticClass:"page"},[a("Page",{attrs:{current:e.searchData.p,"page-size":e.searchData.page,"show-elevator":"","show-sizer":"",size:"small",total:e.searchData.count,transfer:""},on:{"on-change":e.currentPage,"on-page-size-change":e.pageSizeChange}})],1)],1),a("Modal",{attrs:{"footer-hide":!0,scrollable:e.modal.scrollable,styles:e.modal.styles,title:e.modal.title,width:e.modal.width},model:{value:e.modal.show,callback:function(a){e.$set(e.modal,"show",a)},expression:"modal.show"}},[e.modalShow("VipDetails")?a("VipDetails",{on:{"close-modal":e.closeModal}}):e._e(),e.modalShow("VipInfoDetails")?a("VipInfoDetails",{attrs:{"member-info":e.memberInfo},on:{refreshMemberInfo:e.refreshMemberInfo}}):e._e()],1)],1)},r=[],n=function(){var e=this,a=e._self._c;return a("div",{staticClass:"VipSearch"},[a("div",{staticClass:"topic-nav"},[a("div",{staticClass:"left"},[a("Input",{attrs:{clearable:"","enter-button":"",placeholder:"输入姓名/手机号/卡号",search:""},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.search,callback:function(a){e.$set(e.formData,"search",a)},expression:"formData.search"}})],1),a("div",{staticClass:"right"},[a("div",{staticClass:"cell"},[a("Button",{attrs:{icon:"md-person-add",type:"primary"},on:{click:function(a){return e.showModal("新增会员","VipInfoDetails")}}},[e._v(" 新增会员 ")])],1),a("div",{staticClass:"cell"},[a("Button",{attrs:{icon:"ios-cloud-upload",type:"primary"}},[e._v("导入会员")])],1),a("div",{staticClass:"cell"},[a("Button",{attrs:{icon:"ios-cloud-download",type:"primary"}},[e._v("导出会员")])],1),a("div",{staticClass:"cell"},[a("Button",{attrs:{icon:"md-mail",type:"primary"}},[e._v("批量群发")])],1)])]),a("SearchVipMultipleConditions",{on:{search:e.select}}),a("Modal",{attrs:{"footer-hide":!0,scrollable:e.modal.scrollable,styles:e.modal.styles,title:e.modal.title,width:e.modal.width},model:{value:e.modal.show,callback:function(a){e.$set(e.modal,"show",a)},expression:"modal.show"}},[e.modalShow("VipInfoDetails")?a("VipInfoDetails",{on:{change:e.change}}):e._e()],1)],1)},c=[],d=t(94416),o=function(){var e=this,a=e._self._c;return a("div",{staticClass:"SearchVipMultipleConditions"},[a("div",{class:["search",1===e.type?"search-type":""]},[a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("消费金额:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["money_start","money_end"])}}},[e._v(" 全部 ")]),a("div",[a("Input",{staticStyle:{width:"100px"},attrs:{placeholder:"输入金额",size:"small"},model:{value:e.formData.money_start,callback:function(a){e.$set(e.formData,"money_start",a)},expression:"formData.money_start"}})],1),a("div",{staticStyle:{"text-align":"center"}},[e._v("-")]),a("div",[a("Input",{staticStyle:{width:"150px"},attrs:{clearable:"","enter-button":"确定",placeholder:"输入金额",search:"",size:"small"},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.money_end,callback:function(a){e.$set(e.formData,"money_end",a)},expression:"formData.money_end"}})],1)]),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("未到店:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["day"])}}},[e._v("全部")]),e._l(e.beforeShopList,(function(t){return a("div",{key:t.value,class:["text",e.formData.day===t.value?"active":""],on:{click:function(a){return e.beforeShop(t)}}},[e._v(" "+e._s(t.label)+" ")])})),a("div",{staticClass:"search-bt"},[a("Input",{staticStyle:{width:"120px"},attrs:{clearable:"","enter-button":"确定",placeholder:"自定义天",search:"",size:"small"},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.day,callback:function(a){e.$set(e.formData,"day",a)},expression:"formData.day"}})],1)],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("到店频次:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["frequency"])}}},[e._v("全部")]),e._l(e.shopFrequencyList,(function(t){return a("div",{key:t.value,class:["text",e.formData.frequency===t.value?"active":""],on:{click:function(a){return e.shopFrequency(t)}}},[e._v(" "+e._s(t.label)+" ")])})),a("div",[a("Input",{staticStyle:{width:"120px"},attrs:{clearable:"","enter-button":"确定",placeholder:"自定义天",search:"",size:"small"},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.frequency,callback:function(a){e.$set(e.formData,"frequency",a)},expression:"formData.frequency"}})],1)],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("宝宝生日:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["bb_birth"])}}},[e._v("全部")]),e._l(e.babyBirthdayList,(function(t){return a("div",{key:t.value,class:["text",e.formData.bb_birth===t.value?"active":""],on:{click:function(a){return e.babyBirthday(t)}}},[e._v(" "+e._s(t.label)+" ")])})),a("div",[a("Input",{staticStyle:{width:"120px"},attrs:{clearable:"","enter-button":"确定",placeholder:"自定义天",search:"",size:"small"},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.bb_birth,callback:function(a){e.$set(e.formData,"bb_birth",a)},expression:"formData.bb_birth"}})],1)],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("近期生日:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["birth"])}}},[e._v("全部")]),e._l(e.recentBirthdayList,(function(t){return a("div",{key:t.value,class:["text",e.formData.birth===t.value?"active":""],on:{click:function(a){return e.recentBirthday(t)}}},[e._v(" "+e._s(t.label)+" ")])})),a("div",[a("Input",{staticStyle:{width:"120px"},attrs:{clearable:"","enter-button":"确定",placeholder:"自定义天",search:"",size:"small"},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.birth,callback:function(a){e.$set(e.formData,"birth",a)},expression:"formData.birth"}})],1)],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("经期时间:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["period"])}}},[e._v("全部")]),e._l(e.periodList,(function(t){return a("div",{key:t.value,class:["text",e.formData.period===t.value?"active":""],on:{click:function(a){return e.period(t)}}},[e._v(" "+e._s(t.label)+" ")])})),a("div",[a("Input",{staticStyle:{width:"120px"},attrs:{clearable:"","enter-button":"确定",placeholder:"自定义天",search:"",size:"small"},on:{"on-clear":e.search,"on-search":e.search},model:{value:e.formData.period,callback:function(a){e.$set(e.formData,"period",a)},expression:"formData.period"}})],1)],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("会员等级:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["tid"])}}},[e._v("全部")]),e._l(e.gradeList,(function(t){return a("div",{key:t.id,class:["text",e.formData.tid===t.id?"active":""],on:{click:function(a){return e.memberGrade(t)}}},[e._v(" "+e._s(t.name)+" ")])}))],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("来源渠道:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["source_id"])}}},[e._v("全部")]),e._l(e.sourceList,(function(t){return a("div",{key:t.id,class:["text",e.formData.source_id===t.id?"active":""],on:{click:function(a){return e.memberSource(t)}}},[e._v(" "+e._s(t.name)+" ")])})),a("div",{class:["text",-1===e.formData.source_id?"active":""],on:{click:function(a){return e.memberSource({id:-1,name:"未设置"})}}},[e._v(" 未设置 ")])],2),a("div",{class:["row",1===e.type?"row-width":""]},[a("div",{staticClass:"label"},[e._v("所属门店:")]),a("div",{staticClass:"all",on:{click:function(a){return e.clearValue(["sid"])}}},[e._v("全部")]),e._l(e.shopList,(function(t){return a("div",{key:t.id,class:["text",e.formData.sid===t.id?"active":""],on:{click:function(a){return e.shop(t)}}},[e._v(" "+e._s(t.name)+" ")])}))],2)])])},u=[],h=t(48803),v={name:"SearchVipMultipleConditions",props:{type:{type:Number,default:1}},data:function(){return{formData:{money_start:"",money_end:"",start:"",end:"",tid:"",source_id:"",search:"",birth:"",bb_birth:"",period:"",day:"",frequency:"",sid:""},beforeShopList:[{label:"超过一个月未到店",value:"30"},{label:"超过两个月未到店",value:"60"},{label:"超过三个月未到店",value:"90"},{label:"超过半年未到店",value:"180"}],shopFrequencyList:[{label:"1次以内/月",value:"1"},{label:"2次以内/月",value:"2"},{label:"3次以内/月",value:"3"}],babyBirthdayList:[{label:"近三天过生日",value:"3"},{label:"近一周过生日",value:"7"},{label:"近三周过生日",value:"21"}],recentBirthdayList:[{label:"近三天过生日",value:"3"},{label:"近一周过生日",value:"7"},{label:"近三周过生日",value:"21"}],periodList:[{label:"近三天过",value:"3"},{label:"近一周过",value:"7"}],gradeList:[],sourceList:[],shopList:[]}},created(){this.getGradeList(),this.getSourceList(),this.getShopList()},methods:{search(){this.$emit("search",this.formData)},beforeShop(e){this.formData.day=e.value,this.search()},shopFrequency(e){this.formData.frequency=e.value,this.search()},babyBirthday(e){this.formData.bb_birth=e.value,this.search()},recentBirthday(e){this.formData.birth=e.value,this.search()},memberGrade(e){this.formData.tid=e.id,this.search()},memberSource(e){this.formData.source_id=e.id,this.search()},shop(e){this.formData.sid=e.id,this.search()},period(e){this.formData.period=e.value,this.search()},clearValue(e){e.forEach((e=>{this.formData[e]=""})),this.search()},async getGradeList(){const{data:e}=await(0,h.HW)({search:"",page:100,p:1});this.gradeList=e.list},async getSourceList(){const{data:e}=await(0,h.Ue)({search:"",page:100,p:1});this.sourceList=e.list},async getShopList(){this.loading=!0;const{data:e}=await(0,h.IU)({search:"",page:100,p:1});this.shopList=e.list}}},p=v,b=t(1001),m=(0,b.Z)(p,o,u,!1,null,"546234c0",null),y=m.exports,f={name:"VipSearch",components:{SearchVipMultipleConditions:y,VipInfoDetails:d.Z},data:function(){return{modal:{show:!1,title:"",type:!1,width:600,scrollable:!0,styles:{top:"50px"}},formData:{search:""}}},computed:{modalShow(){return e=>this.modal.type===e&&this.modal.show}},created(){},methods:{change(){this.modal.show=!1,this.$emit("change")},showModal(e,a,t={}){console.log(t),this.modal.show=!0,this.modal.title=e,this.modal.type=a},select(e){e.search=this.formData.search,this.formData=e,this.search()},search(){this.$emit("search",this.formData)}}},g=f,_=(0,b.Z)(g,n,c,!1,null,"11af7844",null),x=_.exports,w=t(53012),k=t(50680),C=t(69231),S={name:"VipList1",components:{VipSearch:x,VipDetails:C.Z,VipInfoDetails:d.Z},data:function(){return{loading:!1,tableHeight:0,tableData:[],tableColumns:[{title:"会员信息",key:"name",width:140},{title:"会员账户",key:"username",width:120},{title:"总消费",key:"money",width:120},{title:"到店次数",key:"count",width:120},{title:"上次消费",key:"money1",width:120},{title:"来源",key:"source_name",width:120},{title:"生日",key:"birthday",width:120},{title:"顾问",key:"adviser_name",width:120},{title:"绑定状态",key:"status",width:120}],moreList:[{label:"编辑",value:"1"},{label:"开单",value:"2"}],searchData:{p:1,page:10,count:0},default_avatar:w,vip_total:0,arrears:0,money:0,memberInfo:{},WeComImgUrl:t(6312),WeChatImgUrl:t(76719),modal:{show:!1,title:"",type:!1,width:1e3,scrollable:!0,styles:{top:"50px"}}}},computed:{modalShow(){return e=>this.modal.type===e&&this.modal.show},avatar(){return e=>""===e||null===e?this.default_avatar:e}},created(){this.getTotal(),this.getList()},methods:{searchValues(e){this.searchData=e,this.search()},change(){this.getTotal(),this.getList()},currentPage(e){this.searchData.p=e,this.getList()},pageSizeChange(e){this.searchData.page=e,this.search()},search(){this.searchData.p=1,this.getList()},async getList(){this.loading=!0;const{data:e}=await(0,h.x5)(this.searchData);this.loading=!1,this.tableData=e.list,this.searchData.count=Number(e.count),this.searchData.p=Number(e.p)},async getTotal(){const{data:e}=await(0,h.F7)({});this.money=e.money,this.vip_total=e.vip_total,this.arrears=e.arrears},closeModal(){this.modal.show=!1},showModal(e,a,t){switch(k.Z.set("vid",t.id),console.log(t.id),this.modal.show=!0,this.modal.title=e,this.modal.type=a,a){case"VipInfoDetails":this.modal.width=600;break;default:this.modal.width=window.innerWidth-300}},choose(e,a){switch(this.memberInfo=a,e.label){case"编辑":this.showModal("编辑会员资料","VipInfoDetails",a);break;case"开单":this.jumpRouter("cashier.index");break}console.log(e)},jumpRouter(e,a={}){this.$router.push({name:e,params:a})},refreshMemberInfo(){this.modal.show=!1,this.getMemberList()}}},D=S,R=(0,b.Z)(D,s,r,!1,null,"5b6dfc8f",null),I=R.exports,V=function(){var e=this,a=e._self._c;return a("div",{staticClass:"PrecisionFilter"},[a("VipSearch"),a("div",{staticClass:"list-top"},[e._m(0),a("div",{staticClass:"bt-left"},[a("Button",{staticClass:"add-bt",attrs:{type:"primary"}},[e._v("批量群发")]),a("Button",{staticClass:"add-bt",attrs:{type:"primary"}},[e._v("批量送积分")]),a("Button",{staticClass:"add-bt",attrs:{type:"primary"}},[e._v("企微群发")])],1),a("div",{staticClass:"bt-right"},[a("div",{staticClass:"add-bt",on:{click:e.exportDataEvent}},[e._v("导出")])])]),a("div",{staticClass:"list"},[a("vxe-table",{ref:"xTable",attrs:{"cell-style":{textAlign:"center"},"column-config":{resizable:!0},data:e.tableData,"header-align":"center",height:e.tableHeight,loading:e.loading,"row-config":{isHover:!0},size:"small"}},e._l(e.tableColumns,(function(e,t){return a("vxe-column",{key:t+e.key,attrs:{field:e.key,fixed:e.fixed,"min-width":e.width,"show-overflow":"title",title:e.title}})})),1),a("div",{staticClass:"page"},[a("Page",{attrs:{current:e.searchData.p,"page-size":e.searchData.page,"show-elevator":"","show-sizer":"",size:"small",total:e.searchData.count,transfer:""},on:{"on-change":e.currentPage,"on-page-size-change":e.pageSizeChange}})],1)],1)],1)},$=[function(){var e=this,a=e._self._c;return a("div",[a("span",{staticClass:"black"},[e._v("筛选结果")]),a("span",{staticClass:"grey"},[e._v("共找到0个会员")])])}],L=function(){var e=this,a=e._self._c;return a("div",{staticClass:"VipSearch"},[a("Row",[a("Col",[a("Row",{staticClass:"row"},[a("Col",{staticClass:"label"},[e._v("选择分类:")]),e._l(e.search.data,(function(t){return a("Col",{key:t.id},[a("div",{class:["bt",e.current.one.id===t.id?"isActive":"bt"],on:{click:function(a){return e.changeType1(t)}}},[e._v(" "+e._s(t.name)+" ")])])}))],2),e.search.select1.length>0?a("Row",{staticClass:"row"},[a("Col",{staticClass:"label"},[e._v("选择条件:")]),e._l(e.search.select1,(function(t){return a("Col",{key:t.id,staticClass:"text"},[a("span",{class:["",e.current.tow.id===t.id?"isActive":""],on:{click:function(a){return e.changeType2(t)}}},[e._v(" "+e._s(t.label)+" ")])])}))],2):e._e(),e.search.select2.length>0?a("Row",{staticClass:"row"},[a("Col",{staticClass:"label"},[e._v("具体筛选:")]),a("div",{staticClass:"flex"},e._l(e.search.select2,(function(t){return a("Col",{key:t.id,staticClass:"text"},["text"===t.type?[a("span",{class:["",e.current.thirdly.id===t.id?"isActive":""],on:{click:function(a){return e.changeType3(t)}}},[e._v(" "+e._s(t.label)+" ")])]:e._e(),"daterange"===t.type?[t.label?a("span",{class:["",e.current.thirdly.id===t.id?"isActive":""],on:{click:function(a){return e.changeType3(t)}}},[e._v(" "+e._s(t.label)+" ")]):e._e(),a("DatePicker",{staticStyle:{width:"180px","margin-left":"2px"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",transfer:"",type:"daterange","value-format":"yyyy-MM-dd"},on:{"on-change":function(e){t.value=e},"on-open-change":function(a){return e.changeDatePicker(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})]:e._e(),"select"===t.type?[a("Select",{staticStyle:{width:"260px","text-align":"left"},attrs:{clearable:"",filterable:-1!==t.param.indexOf("filterable"),multiple:-1!==t.param.indexOf("multiple"),placeholder:t.label,transfer:""},on:{"on-open-change":function(a){return e.changeSelect(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(t.list,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)]:e._e(),"between"===t.type?[a("div",{staticStyle:{display:"flex","align-items":"center"},on:{click:function(a){return e.setBetWeen(t)}}},[a("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"最小"+t.label,type:"number"},model:{value:t.value.min,callback:function(a){e.$set(t.value,"min",a)},expression:"item.value.min"}}),e._v(" - "),a("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"最大"+t.label,type:"number"},model:{value:t.value.max,callback:function(a){e.$set(t.value,"max",a)},expression:"item.value.max"}}),t.date&&"select"===t.date.type?a("Select",{staticStyle:{width:"180px","margin-left":"4px","text-align":"left"},attrs:{clearable:"",filterable:-1!==t.date.param.indexOf("filterable"),multiple:-1!==t.date.param.indexOf("multiple"),placeholder:t.date.label,transfer:""},on:{"on-open-change":function(a){return e.changeSelect(t)}},model:{value:t.date.value,callback:function(a){e.$set(t.date,"value",a)},expression:"item.date.value"}},e._l(t.date.list,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e(),t.date&&"自定义时间"===t.date.value?a("DatePicker",{staticStyle:{width:"180px","margin-left":"2px"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",transfer:"",type:"daterange","value-format":"yyyy-MM-dd"},on:{"on-change":function(e){t.dateRange.value=e},"on-open-change":function(a){return e.changeDatePicker(t)}},model:{value:t.dateRange.value,callback:function(a){e.$set(t.dateRange,"value",a)},expression:"item.dateRange.value"}}):e._e()],1)]:e._e(),"group"===t.type?[a("div",{staticStyle:{display:"flex","align-items":"center"}},[t.card?a("Select",{staticStyle:{width:"180px","text-align":"left"},attrs:{clearable:"",filterable:-1!==t.param.indexOf("filterable"),multiple:-1!==t.param.indexOf("multiple"),placeholder:t.card.label,transfer:""},on:{"on-open-change":function(a){return e.changeSelect(t)}},model:{value:t.card.value,callback:function(a){e.$set(t.card,"value",a)},expression:"item.card.value"}},e._l(t.card.list,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e(),a("Select",{staticStyle:{width:"180px","margin-left":"4px","text-align":"left"},attrs:{clearable:"",filterable:-1!==t.param.indexOf("filterable"),multiple:-1!==t.param.indexOf("multiple"),placeholder:t.term.label,transfer:""},on:{"on-open-change":function(a){return e.changeSelect(t)}},model:{value:t.term.value,callback:function(a){e.$set(t.term,"value",a)},expression:"item.term.value"}},e._l(t.term.list,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1),"区间"===t.term.value?a("div",{staticStyle:{"margin-left":"4px"}},[a("Input",{staticStyle:{width:"90px"},attrs:{type:"number"},model:{value:t.data.min,callback:function(a){e.$set(t.data,"min",a)},expression:"item.data.min"}}),e._v(" - "),a("Input",{staticStyle:{width:"90px"},attrs:{type:"number"},model:{value:t.data.max,callback:function(a){e.$set(t.data,"max",a)},expression:"item.data.max"}})],1):a("div",{staticStyle:{"margin-left":"4px"}},[a("Input",{staticStyle:{width:"180px"},attrs:{type:"number"},model:{value:t.data.val,callback:function(a){e.$set(t.data,"val",a)},expression:"item.data.val"}})],1),t.date&&"select"===t.date.type?a("Select",{staticStyle:{width:"180px","margin-left":"4px","text-align":"left"},attrs:{clearable:"",filterable:-1!==t.date.param.indexOf("filterable"),multiple:-1!==t.date.param.indexOf("multiple"),placeholder:t.date.label,transfer:""},on:{"on-open-change":function(a){return e.changeSelect(t)}},model:{value:t.date.value,callback:function(a){e.$set(t.date,"value",a)},expression:"item.date.value"}},e._l(t.date.list,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e(),t.dateRange&&!t.date||t.date&&"自定义时间"===t.date.value?a("div",{staticStyle:{"margin-left":"4px"}},[t.dateRange.label?a("span",{class:["",e.current.thirdly.dateRange&&e.current.thirdly.dateRange.id===t.dateRange.id?"isActive":""],on:{click:function(a){return e.changeType3(t)}}},[e._v(" "+e._s(t.dateRange.label)+" ")]):e._e(),a("DatePicker",{staticStyle:{width:"180px","margin-left":"2px"},attrs:{format:"yyyy-MM-dd",placeholder:"选择日期",transfer:"",type:"daterange","value-format":"yyyy-MM-dd"},on:{"on-change":function(e){t.dateRange.value=e},"on-open-change":function(a){return e.changeDatePicker(t)}},model:{value:t.dateRange.value,callback:function(a){e.$set(t.dateRange,"value",a)},expression:"item.dateRange.value"}})],1):e._e()],1)]:e._e(),"input"===t.type?[t.label?a("span",{class:["",e.current.thirdly.id===t.id?"isActive":""],on:{click:function(a){return e.changeType3(t)}}},[e._v(" "+e._s(t.label)+" ")]):e._e(),a("Input",{staticStyle:{width:"100px"},on:{"on-change":function(a){return e.changeInput(t)},"on-focus":function(a){return e.changeInput(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),e._v(" 天 ")]:e._e()],2)})),1),a("Col",{staticClass:"text"},[a("Button",{attrs:{type:"primary"},on:{click:e.addSearch}},[e._v("添加筛选")])],1)],1):e._e()],1)],1),a("Row",{staticClass:"terms"},[a("Col",[a("Row",{staticClass:"row"},[a("Col",{staticClass:"label"},[e._v("筛选条件:")]),e._l(e.search_list,(function(t,l){return a("Col",{key:l},[a("Tag",{attrs:{closable:"",name:l},on:{"on-close":e.handleClose}},[e._v(" "+e._s(t.title)+":"+e._s(t.value)+" ")])],1)}))],2)],1)],1)],1)},M=[],T={name:"VipSearch",data:function(){return{search:{data:[{name:"基本信息",id:1,children:[{id:1,label:"性别",name:"sex",children:[{id:1,label:"女",value:"女",type:"text"},{id:2,label:"男",value:"男",type:"text"}]},{id:2,label:"来源渠道",name:"source",children:[{id:1,label:"自然进店",value:"自然进店",type:"text"},{id:2,label:"美团",value:"美团",type:"text"}]},{id:3,label:"近期生日",name:"birthday",children:[{id:1,label:"近3天",value:"近3天",type:"text"},{id:2,label:"近7天",value:"近7天",type:"text"},{id:3,label:"近半天",value:"近半天",type:"text"},{id:4,label:"自定义",value:[],type:"daterange"}]},{id:4,label:"所属门店",name:"store",children:[{id:1,label:"惠城总店",value:"惠城总店",type:"text"}]}]},{name:"高级信息",id:2,children:[{id:1,label:"会员等级",name:"",children:[{id:1,label:"请选择会员等级",value:"",type:"select",param:["multiple"],list:[{id:1,label:"铂金",value:"铂金"},{id:2,label:"黄金",value:"黄金"},{id:3,label:"黑钻",value:"黑钻"}]}]},{id:2,label:"生命周期",name:"",children:[{id:1,label:"新客户",value:"新客户",type:"text"},{id:2,label:"活跃客户",value:"活跃客户",type:"text"},{id:3,label:"沉睡客户",value:"沉睡客户",type:"text"},{id:4,label:"流失客户",value:"流失客户",type:"text"},{id:5,label:"结束客户",value:"结束客户",type:"text"}]},{id:3,label:"个性标签",name:"",children:[{id:1,label:"请选择",value:"",type:"select",param:["multiple","filterable"],list:[{id:1,label:"有钱人",value:"有钱人"},{id:2,label:"喜欢奢侈品",value:"喜欢奢侈品"},{id:3,label:"A类客户",value:"A类客户"},{id:4,label:"超A类客户",value:"超A类客户"},{id:5,label:"消费能力强",value:"消费能力强"}]}]},{id:4,label:"专属顾问",name:"",children:[{id:1,label:"请选择",value:"",type:"select",param:["multiple"],list:[{id:1,label:"顾问1",value:"顾问1"},{id:2,label:"顾问2",value:"顾问2"}]}]},{id:5,label:"建档日期",name:"",children:[{id:1,label:"",value:[],type:"daterange"}]},{id:6,label:"有转介绍的会员",name:"",children:[{id:1,label:"有转介绍的会员",value:"有转介绍的会员",type:"text"}]},{id:7,label:"首次到店时间",name:"",children:[{id:1,label:"",value:[],type:"daterange"}]},{id:8,label:"绑定公众号",name:"",children:[{id:1,label:"已绑定",value:"已绑定",type:"text"},{id:2,label:"未绑定",value:"未绑定",type:"text"}]},{id:9,label:"绑定企业微信",name:"",children:[{id:1,label:"已绑定",value:"已绑定",type:"text"},{id:2,label:"未绑定",value:"未绑定",type:"text"}]}]},{name:"资产信息",id:3,children:[{id:1,label:"卡筛选",name:"",children:[{id:1,label:"未持卡",value:"未持卡",type:"text"},{id:2,label:"持卡",value:"持卡",type:"text"},{id:3,label:"卡状态",value:"",type:"select",param:[],list:[{id:1,label:"使用中",value:"使用中"},{id:2,label:"未使用",value:"未使用"},{id:3,label:"已过期",value:"已过期"},{id:4,label:"已结束",value:"已结束"}]}]},{id:2,label:"剩余积分",name:"",children:[{id:1,label:"积分",value:{min:"",max:""},type:"between"}]},{id:3,label:"储值卡余额",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]}}]},{id:4,label:"次卡余额",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",card:{id:1,label:"请选择次卡",value:"",param:[],list:[{id:1,label:"次卡1",value:"次卡1"},{id:1,label:"次卡2",value:"次卡2"}]},term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]}}]},{id:5,label:"欠款",name:"",children:[{id:1,label:"欠款",value:{min:"",max:""},type:"between"}]},{id:6,label:"次卡有效期",name:"",children:[{id:1,label:"已到期",value:"已到期",type:"text"},{id:2,label:"未到期",value:"未到期",type:"text"},{id:3,label:"半月内到期",value:"半月内到期",type:"text"},{id:4,label:"1个月内到期",value:"1个月内到期",type:"text"},{id:5,label:"2个月内到期",value:"2个月内到期",type:"text"},{id:6,label:"自定义",value:"",type:"input"}]}]},{name:"消费能力",id:4,children:[{id:1,label:"多久未消费 ",name:"",children:[{id:1,label:"超过1个月 ",value:"超过1个月",type:"text"},{id:2,label:"超过2个月",value:"超过2个月",type:"text"},{id:3,label:"超过半年",value:"超过半年",type:"text"}]},{id:2,label:"单次充值",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]},{id:3,label:"累计充值",name:"",children:[{id:1,label:"充值金额",value:{min:"",max:""},type:"between",date:{value:[],type:"select",param:[],list:[{id:1,label:"近一周",value:"近一周"},{id:2,label:"近一个月",value:"近一个月"},{id:3,label:"近三个月",value:"近三个月"},{id:4,label:"近半年",value:"近半年"},{id:5,label:"近一年",value:"近一年"},{id:0,label:"自定义时间",value:"自定义时间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]},{id:4,label:"单次消费",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]},{id:5,label:"累计消费",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]},{id:6,label:"会员到店",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",date:{value:[],type:"select",param:[],list:[{id:1,label:"近一周",value:"近一周"},{id:2,label:"近一个月",value:"近一个月"},{id:3,label:"近三个月",value:"近三个月"},{id:4,label:"近半年",value:"近半年"},{id:5,label:"近一年",value:"近一年"},{id:0,label:"自定义时间",value:"自定义时间"}]},term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]},{id:7,label:"会员耗卡",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",date:{value:[],type:"select",param:[],list:[{id:1,label:"近一周",value:"近一周"},{id:2,label:"近一个月",value:"近一个月"},{id:3,label:"近三个月",value:"近三个月"},{id:4,label:"近半年",value:"近半年"},{id:5,label:"近一年",value:"近一年"},{id:0,label:"自定义时间",value:"自定义时间"}]},term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]},{id:8,label:"消费频率",name:"",children:[{id:1,label:"请选择条件",value:[],data:{val:"",max:"",min:""},param:[],type:"group",date:{value:[],type:"select",param:[],list:[{id:1,label:"近一周",value:"近一周"},{id:2,label:"近一个月",value:"近一个月"},{id:3,label:"近三个月",value:"近三个月"},{id:4,label:"近半年",value:"近半年"},{id:5,label:"近一年",value:"近一年"},{id:0,label:"自定义时间",value:"自定义时间"}]},term:{id:1,label:"请选择条件",value:"",param:[],list:[{id:1,label:"大于",value:"大于"},{id:2,label:"小于",value:"小于"},{id:3,label:"等于",value:"等于"},{id:4,label:"区间",value:"区间"}]},dateRange:{id:1,label:"",value:[],type:"daterange"}}]}]}],select1:[],select2:[]},search_list:[],current:{one:[],tow:[],thirdly:[]}}},created(){},methods:{changeSelect:function(e){this.changeType3(e)},changeDatePicker:function(e){this.changeType3(e)},changeInput:function(e){this.changeType3(e)},setBetWeen(e){this.changeType3(e)},checkBetWeen(e){let a=[];if(!e.date||!e.date.value||e.date.value.length<1){if(""===e.value.min)return this.$Message.warning("请输入最小值"),!1;if(""===e.value.max)return this.$Message.warning("请输入最大值"),!1}return e.value.max&&e.value.min&&a.push({max:e.value.max,min:e.value.min}),e.date&&e.date.value&&("自定义时间"===e.date.value?(e.dateRange.value.forEach((function(a){a||(e.dateRange.value=[])})),e.dateRange.value.length>0&&a.push({date:e.dateRange.value})):a.push({date:[e.date.value]})),e.value=a,!0},checkSelectInput(e){e.value=[];let a=[];if(e.card){if(""===e.card.value)return this.$Message.warning("请选择次卡"),!1;a.push(e.card.value)}if(e.date)"自定义时间"!==e.date.value&&(e.dateRange.value=[e.date.value]);else if(e.dateRange&&(!e.dateRange||!e.dateRange.value||e.dateRange.value.length<1)&&!e.term.value)return this.$Message.warning("请选择条件"),!1;if(e.dateRange&&e.dateRange.value.forEach((function(a){a||(e.dateRange.value=[])})),e.term.value)if(a.push(e.term.value),"区间"===e.term.value){if(""===e.data.min)return this.$Message.warning("请输入最小值"),!1;if(""===e.data.max)return this.$Message.warning("请输入最大值"),!1;a.push({min:e.data.min,max:e.data.max})}else{if(""===e.data.val)return this.$Message.warning("请输入值"),!1;a.push(e.data.val)}return e.dateRange&&e.dateRange.value.length>0&&a.push({date:e.dateRange.value}),e.value=a,!0},changeType1:function(e){this.search.select1=e.children,this.current.one=e,this.current.tow=[],this.current.thirdly=[]},changeType2:function(e){console.log(e),this.search.select2=e.children,this.current.tow=e,this.current.thirdly=[]},changeType3:function(e){if(this.current.tow.length<1)return!1;this.current.thirdly=e},addSearch:function(){if(this.current.tow.length<1)return this.$Message.warning("请选择筛选条件"),!1;if(this.current.thirdly.length<1)return this.$Message.warning("请选择具体筛选条件"),!1;if("between"===this.current.thirdly.type&&!this.checkBetWeen(this.current.thirdly))return!1;if("group"===this.current.thirdly.type&&!this.checkSelectInput(this.current.thirdly))return!1;let e=this.current.one.id+"_"+this.current.tow.id;for(let a=0;a<this.search_list.length;a++)this.search_list[a].id===e&&this.search_list.splice(a,1);return!!this.current.thirdly.value&&(!(this.current.thirdly.value instanceof Array&&0===this.current.thirdly.value.length)&&(this.search_list.push({id:e,title:this.current.tow.label,name:this.current.tow.name,value:this.current.thirdly.value}),void console.log("search_list",this.search_list)))},handleClose(e,a){this.search_list.splice(a,1)}}},z=T,B=(0,b.Z)(z,L,M,!1,null,"f164d1be",null),P=B.exports,H={name:"PrecisionFilter",components:{VipSearch:P},data:function(){return{loading:!1,tableHeight:0,tableData:[{0:"测试测试"}],tableColumns:[{title:"会员信息",key:"0"},{title:"会员账户",key:"1"},{title:"总消费",key:"2"},{title:"到店次数",key:"3"},{title:"上次消费",key:"4"},{title:"来源",key:"5"},{title:"生日",key:"6"},{title:"顾问",key:"7"},{title:"锁定状态",key:"8"}],searchData:{p:1,page:10,count:0}}},mounted(){this.setHeight(),window.onresize=()=>{this.setHeight()}},methods:{setHeight(){},currentPage(e){this.searchData.p=e,this.getList()},pageSizeChange(e){this.searchData.page=e,this.search()},search(){this.searchData.p=1,this.getList()},exportDataEvent(){setTimeout((()=>{const e=[];this.$refs.xTable.exportData({filename:"",type:"csv",isHeader:!0,isFooter:!0,data:e})}),100)}}},O=H,A=(0,b.Z)(O,V,$,!1,null,"c6748f40",null),q=A.exports,F={name:"Index",components:{VipList:I,PrecisionFilter:q},data:function(){return{tab_index:"会员列表",tab_list:[{name:"会员列表",id:1},{name:"精准筛选",id:2}]}},computed:{current(){return(e,a)=>a===e.name&&this.tab_index===a}},mounted(){this.$nextTick((()=>{this.tabHeight()}))},methods:{tabHeight(){let e=window.innerHeight,a=e-230;this.$refs.tab.style.minHeight=a+"px",console.log(e,a)},handleTabClick(e){this.tabHeight(),this.tab_index=e}}},W=F,Z=(0,b.Z)(W,l,i,!1,null,"45c02689",null),U=Z.exports}}]);
//# sourceMappingURL=991.cb2eb18b.js.map